
@{
    ViewBag.Title = "SoCPdfRegistration";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@* custom browse file js *@
<script>
    $(document).ready(function () {
        bsCustomFileInput.init()
    });



</script>
<div class="mt-3 box-properties">

    <div class="tabHead mb-3">
        <div class="row">
            <div class="col-md-6"><h4>SoC Upload</h4></div>

        </div>
    </div>
    <div class="mt-3">

        <form method="post" enctype="multipart/form-data">
            <div class="jumbotron socBox">
                <div class="form-group row">

                    <label for=" " class="col-sm-3 col-form-label">SoC Type</label>
                    <div class="col-sm-9">
                        <div class="form-group m-0">
                            <select id="SoC_Type" class="form-select form-control" name="SoC_Type">
                                <option value="AoN Accord">AoN Accord</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="form-group row">

                    <label for=" " class="col-sm-3 col-form-label">Upload SoC * </label>
                    <div class="col-sm-9">
                        <label class="labeltext font-weight-bold mb-0">(Upload only <b> (.doc or docx)</b> file)</label>
                        <div class="custom-file">


                            <input type="file" name="file" class="custom-file-input" id="SOC_Files2" />
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                </div>

                <div class="form-group row">
                    <label for=" " class="col-sm-3 col-form-label">Upload SoC PPT</label>
                    <div class="col-sm-9">
                        <label class="labeltext font-weight-bold mb-0">(Upload only <b> (.ppt)</b> file)</label>
                        <div class="custom-file">

                            <input type="file" name="file" class="custom-file-input" id="SOC_Files4" />
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                </div>

                <div class="form-group row">
                    <label for=" " class="col-sm-3 col-form-label">Upload Chairman's brief</label>
                    <div class="col-sm-9">
                        <label class="labeltext font-weight-bold mb-0">(Upload only <b> (.pdf)</b> file)</label>
                        <div class="custom-file">

                            <input type="file" name="file" class="custom-file-input" id="SOC_Files6" />
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <label for=" " class="col-sm-3 col-form-label">Upload Draft RFP</label>
                    <div class="col-sm-9">
                        <label class="labeltext font-weight-bold mb-0">(Upload only <b> (.pdf)</b> file)</label>
                        <div class="custom-file">

                            <input type="file" name="file" class="custom-file-input" id="SOC_Files7" />
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <label for=" " class="col-sm-3 col-form-label">Upload SoC Annexure(s)</label>
                    <div class="col-sm-9 pt-2 pl-3 bgside" id="mainfileupload">
                        <label class="labeltext font-weight-bold mb-0">(Upload only <b> (.pdf)</b> file)</label>
                        <div class="form-group">
                            <div class="d-flex row">
                                <div class="col-md-12 pb-2">
                                    <input type="text" name="" id="txtFileName" value="" class="form-control mb-1" />
                                    <div class="custom-file">
                                        <input type="file" name="SOC_Files3" class="custom-file-input" id="SOC_Files3" multiple="multiple" />
                                        <label class="custom-file-label" id="lbal1" for="inputGroupFile01">Choose file</label>
                                    </div>

                                </div>
                                <table class="table m-3" id="FilesList" style="visibility:hidden">

                                    <tr class="bg-dark">
                                        <td>
                                            File Name(s)
                                        </td>
                                        <td>
                                            Action
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                   
                </div>
                <div class="form-group row">
                    <label for=" " class="col-sm-3 col-form-label">Upload any Other Document</label>
                    <div class="col-sm-9">
                        <label class="labeltext font-weight-bold mb-0">(Upload only <b> (.pdf)</b> file)</label>
                        <div class="custom-file">

                            <input type="file" name="file" class="custom-file-input" id="SOC_Files5" />
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                </div>
                <div class="col-md-12 text-center">
                    @ViewBag.msg
                   
                    <button type="submit" class="btn btn-primary w-auto text-center">Upload</button>

                </div>
            </div>
        </form>
       
    </div>
    <div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Alert</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="col-md-12">
                        <div id="myTabContent">
                            <div class="tab-pane show" id="home" role="tabpanel" aria-labelledby="home-tab">
                                <div class="row register-form">
                                    <div class="col-md-12 ">
                                        <div id="lblmsg"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div><br>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script>

    $(document).ready(function () {
        var formdata = new FormData(); //FormData object
        $("#SOC_Files3").on("change", function () {
            var ValidFileExtension = ['pdf', 'PDF'];
            if ($.inArray($(this).val().split('.').pop().toLowerCase(), ValidFileExtension) == -1) {
                alert("Sorry !!! Allowed documents are '.pdf','.doc','.ppt'");
                SOC_Files.value = '';
                return false;
            }
            else {
                var FileName = $('#txtFileName').val();
                if (FileName == '') {
                    alert('Please file File Name');
                    return false;
                }

                var files = $("#SOC_Files3").get(0).files;
                var fileData = new FormData();

                for (var i = 0; i < files.length; i++) {
                    fileData.append("fileInput", files[i]);
                }

                $.ajax({
                    type: "POST",
                    url: "/SocPdfRegistration/UploadFiles?id=" + FileName,
                    dataType: "json",
                    contentType: false, // Not to set any content header
                    processData: false, // Not to process data
                    data: fileData,
                    success: function (result, status, xhr) {
                        //alert(result);
                    },
                    error: function (xhr, status, error) {
                       // alert(status);
                    }
                });
                var fileInput = document.getElementById('SOC_Files3');
                if (fileInput)
                    //Iterating through each files selected in fileInput
                    for (i = 0; i < fileInput.files.length; i++) {
                        var sfilename = fileInput.files[i].name;
                        let srandomid = Math.random().toString(36).substring(7);
                        formdata.append(FileName, fileInput.files[i].FileName);
                        //var sFilePath = '/excelfolder/' + sfilename;
                        var markup = "<tr id='" + srandomid + "'><td>" + FileName + "</td><td><a href='/SocPdfRegistration/ViewfileandDoc?path=" + sfilename + "' target='_blank' ><span class='glyphicon glyphicon-remove red'><i class='fas fa-eye text-white'></i></span></a>&nbsp;&nbsp;<a style='display:none' href='#' onclick='DeleteFile(\"" + srandomid + "\",\"" + FileName +
                            "\")'><span class='glyphicon glyphicon-remove red'><i class='fas fa-trash mr-1'></i></span></a></td></tr>"; // Binding the file name

                        $("#FilesList tbody").append(markup);
                    }
                chkatchtbl();
                $("#txtFileName").val('');
                $('#SOC_Files3').val('');
                $('#lbal1').val('');
                return true;
            }
        });
        function chkatchtbl() {
            if ($('#FilesList tr').length > 1) {
                $("#FilesList").css("visibility", "visible");
            } else {
                $("#FilesList").css("visibility", "hidden");
            }
        }
        if ('@ViewBag.UploadStatus' === "File format not correct") {

        $('#lblmsg').html('File format not correct');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "Estimated cost") {

            $('#lblmsg').html('Estimated cost should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "Type") {

            $('#lblmsg').html('Service Lead can not be match');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "Quantity") {

            $('#lblmsg').html('Quantity should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
        if ('@ViewBag.UploadStatus' === "To Be considered by") {

            $('#lblmsg').html('To Be considered by should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "Unique Reference no") {

            $('#lblmsg').html('Unique Reference no should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "CATEGORISATION STATUS") {

            $('#lblmsg').html('CATEGORISATION STATUS should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "SERVICE") {

            $('#lblmsg').html('SERVICE should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "NAME OF PROPOSAL") {

            $('#lblmsg').html('NAME OF PROPOSAL should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.Save' === "SOC Registration Successfully") {

            $('#lblmsg').html('SOC Registration Successfully');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.Save' === "Unique Id already exist") {
            $('#lblmsg').html('Unique Id already exist');
            $('#myModal').modal({
                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
        if ('@ViewBag.NotSave' === "SOC registration not saved") {
            $('#lblmsg').html('SOC registration not saved');
            $('#myModal').modal({
                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
        if ('@ViewBag.UploadStatus' === "Can not be empty SoC meta data") {
            $('#lblmsg').html('Can not be empty SoC meta data');
            $('#myModal').modal({
                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
        if ('@ViewBag.UploadStatus' === "Only .doc or .docx file") {
            $('#lblmsg').html('Only .doc or .docx file');
            $('#myModal').modal({
                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
        if ('@ViewBag.UploadStatus' === "Only .pdf file") {
            $('#lblmsg').html('Only .pdf file');
            $('#myModal').modal({
                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
        if ('@ViewBag.UploadStatus' === "Can not be empty SoC File") {
            $('#lblmsg').html('Can not be empty SoC File');
            $('#myModal').modal({
                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
    });


</script>

