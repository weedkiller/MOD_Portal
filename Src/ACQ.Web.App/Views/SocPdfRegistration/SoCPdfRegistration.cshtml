
@{
    ViewBag.Title = "SoCPdfRegistration";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script nonce="r@nd0m">
    $(document).ready(function () {
        $("#pages").addClass("show");
        $("#mAccess").addClass("activetextclr");
    });
</script>


<div class="mt-3 container-fluid">

    <div class="tabHead mb-1">
        <div class="row">
            <div class="col-md-6"><h3>SoC Upload</h3></div>

        </div>
    </div>

    <div class="">
        <form method="post" htmlAttributes: new { autocomplete="off" , enctype="multipart/form-data" }>
            @Html.AntiForgeryToken()
            @Html.ValidationSummary()
            <div class="card flex-fill w-100 p-3">
                <div class="form-group row">

                    <label for=" " class="col-sm-3 col-form-label">SoC Type</label>
                    <div class="col-sm-9">
                        <div class="form-group m-0">
                            <select id="SoC_Type" class="form-select form-control" name="SoC_Type">
                                <option value="AoN Accord">AoN Accord</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="form-group row">

                    <label for=" " class="col-sm-3 col-form-label">Upload SoC * </label>
                    <div class="col-sm-9">
                        <label class="labeltext font-weight-bold mb-0">(Upload only <b> (.doc or docx)</b> file)</label>
                        <div class="custom-file">
                            <input type="file" name="file" class="form-control-file" id="SOC_Files2" />
                        </div>
                    </div>
                </div>

                <div class="form-group row">
                    <label for=" " class="col-sm-3 col-form-label">Upload SoC PPT</label>
                    <div class="col-sm-9">
                        <label class="labeltext font-weight-bold mb-0">(Upload only <b> (.ppt)</b> file)</label>
                        <div class="custom-file">

                            <input type="file" name="file" class="form-control-file" id="SOC_Files4" />
                        </div>
                    </div>
                </div>

                <div class="form-group row">
                    <label for=" " class="col-sm-3 col-form-label">Upload Chairman's brief</label>
                    <div class="col-sm-9">
                        <label class="labeltext font-weight-bold mb-0">(Upload only <b> (.pdf)</b> file)</label>
                        <div class="custom-file">

                            <input type="file" name="file" class="form-control-file" id="SOC_Files6" />
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <label for=" " class="col-sm-3 col-form-label">Upload Draft RFP</label>
                    <div class="col-sm-9">
                        <label class="labeltext font-weight-bold mb-0">(Upload only <b> (.pdf)</b> file)</label>
                        <div class="custom-file">

                            <input type="file" name="file" class="form-control-file" id="SOC_Files7" />
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <label for=" " class="col-sm-3 col-form-label">Upload SoC Annexure(s)</label>
                    <div class="col-sm-9 pt-2 pl-3 bgside" id="mainfileupload">
                        <label class="labeltext font-weight-bold mb-0">(Upload only <b> (.pdf)</b> file)</label>
                        <div class="form-group">
                            <div class="d-flex row">
                                <div class="col-md-12 pb-2">
                                    <input type="text" name="" id="txtFileName" value="" class="form-control mb-1" />
                                    <div class="custom-file">
                                        <input type="file" name="SOC_Files3" class="form-control-file" id="SOC_Files3" multiple="multiple" />
                                    </div>
                                </div>
                                <table class="table table-bordered m-3" id="FilesList" style="visibility:hidden">
                                    <tr class="bg-primary text-white">
                                        <td>
                                            File Name(s)
                                        </td>
                                        @*<td>
                                            Action
                                        </td>*@
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="form-group row">
                    <label for=" " class="col-sm-3 col-form-label">Upload any Other Document</label>
                    <div class="col-sm-9">
                        <label class="labeltext font-weight-bold mb-0">(Upload only <b> (.pdf)</b> file)</label>
                        <div class="custom-file">

                            <input type="file" name="file" class="form-control-file" id="SOC_Files5" />
                        </div>
                    </div>
                </div>
                <div class="col-md-12 text-center">
                    @ViewBag.msg

                    <button type="submit" class="btn btn-primary w-auto text-center">Upload</button>

                </div>
            </div>
        </form>

    </div>

    <div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Alert</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="col-md-12">
                        <div id="myTabContent">
                            <div class="tab-pane show" id="home" role="tabpanel" aria-labelledby="home-tab">
                                <div class="row register-form">
                                    <div class="col-md-12 ">
                                        <div id="lblmsg"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="clearfix"></div><br>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>
</div>
<script nonce="r@nd0m">

    $(document).ready(function () {
        var formdata = new FormData(); //FormData object
        $("#SOC_Files3").on("change", function () {
            var ValidFileExtension = ['pdf', 'PDF'];
            var file = $("#SOC_Files3").get(0).files;
            if (file.size >= 1 * 1024) {

                $("#form-id").get(0).reset(); //the tricky part is to "empty" the input file here I reset the form.
                return;
            }


            if ($.inArray($(this).val().split('.').pop().toLowerCase(), ValidFileExtension) == -1) {
                alert("Sorry !!! Allowed documents are '.pdf'");
                return false;
            }


            else {
                var FileName = $('#txtFileName').val();
                if (FileName == '') {
                    alert('Please file File Name');
                    return false;
                }


                var files = $("#SOC_Files3").get(0).files;
                var fileData = new FormData();

                for (var i = 0; i < files.length; i++) {
                    fileData.append("fileInput", files[i]);
                }

                $.ajax({
                    type: "POST",
                    url: "/SocPdfRegistration/UploadFiles?id=" + FileName,
                    dataType: "json",
                    contentType: false, // Not to set any content header
                    processData: false, // Not to process data
                    data: fileData,
                    success: function (result, status, xhr) {
                        var fileInput = document.getElementById('SOC_Files3');
                        if (fileInput)
                            //Iterating through each files selected in fileInput
                            for (i = 0; i < fileInput.files.length; i++) {
                                var sfilename = fileInput.files[i].name;
                                let srandomid = Math.random().toString(36).substring(7);
                                formdata.append(FileName, fileInput.files[i].FileName);
                                //var sFilePath = '/excelfolder/' + sfilename;
                                var markup = "<tr id='" + srandomid + "'><td>" + FileName + "</td></tr>"; // Binding the file name

                                $("#FilesList tbody").append(markup);
                            }
                        chkatchtbl();
                        $("#txtFileName").val('');
                        $('#SOC_Files3').val('');
                        $('#lbal1').val('');
                    },
                    error: function (xhr, status, error) {
                        alert("Please upload only .pdf file and File size Should Be UpTo 1 MB");
                        $("#txtFileName").val('');
                        $('#SOC_Files3').val('');
                        $('#lbal1').val('');
                        return false;
                    }
                });

                return true;
            }
        });
        function chkatchtbl() {
            if ($('#FilesList tr').length > 1) {
                $("#FilesList").css("visibility", "visible");
            } else {
                $("#FilesList").css("visibility", "hidden");
            }
        }
        if ('@ViewBag.UploadStatus' === "File format not correct") {

        $('#lblmsg').html('File format not correct');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "Estimated cost") {

            $('#lblmsg').html('Estimated cost should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });


        }

        if ('@ViewBag.UploadStatus' === "Type") {

            $('#lblmsg').html('Service Lead can not be match');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "errormsg") {

            $('#lblmsg').html('@ViewBag.UploadStatusmsg');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "Quantity") {

            $('#lblmsg').html('Quantity should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
        if ('@ViewBag.UploadStatus' === "To Be considered by") {

            $('#lblmsg').html('To Be considered by should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "Unique Reference no") {

            $('#lblmsg').html('Unique Reference no should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "CATEGORISATION STATUS") {

            $('#lblmsg').html('CATEGORISATION STATUS should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "SERVICE") {

            $('#lblmsg').html('SERVICE should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.UploadStatus' === "NAME OF PROPOSAL") {

            $('#lblmsg').html('NAME OF PROPOSAL should not be blank');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.Save' === "SOC Registration Successfully") {

            $('#lblmsg').html('SOC Registration Successfully');
            $('#myModal').modal({

                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }

        if ('@ViewBag.Save' === "Unique Id already exist") {
            $('#lblmsg').html('Unique Id already exist');
            $('#myModal').modal({
                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
        if ('@ViewBag.NotSave' === "SOC registration not saved") {
            $('#lblmsg').html('SOC registration not saved');
            $('#myModal').modal({
                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
        if ('@ViewBag.UploadStatus' === "Can not be empty SoC meta data") {
            $('#lblmsg').html('Can not be empty SoC meta data');
            $('#myModal').modal({
                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
        if ('@ViewBag.UploadStatus' === "Only .doc or .docx file") {
            $('#lblmsg').html('Only .doc or .docx file');
            $('#myModal').modal({
                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
        if ('@ViewBag.UploadStatus' === "Only .pdf file") {
            $('#lblmsg').html('Only .pdf file');
            $('#myModal').modal({
                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
        if ('@ViewBag.UploadStatus' === "Can not be empty SoC File") {
            $('#lblmsg').html('Can not be empty SoC File');
            $('#myModal').modal({
                display: 'show',
                backdrop: 'static',
                keyboard: false
            });
        }
    });


</script>

